function rho = ExponentialAtmDensity_V1_1(h)

%   ExponentialAtmDensity_V1_1.m
%   Made by Sapienza Gn Lab
%
%   Transforms a single deputy satellite's relative coordinates into inertial coordinates.
%
%   INPUT
%   h: Height of the satellite [km].
%
%   OUTPUT
%   rho: Density at altitude h [kg/km^3]


% Table containing atmospheric density at various heights: [h_ellp, h0, rho0, H]. Reference: Vallado pag. 509-510, Table 7.4.
table  = [0      25    0  1.225       7.249; ...
          25     30   25  3.899e-2    6.349; ...
          30     40   30  1.774e-2    6.682; ...
          40     50   40  3.972e-3    7.554; ...
          50     60   50  1.057e-3    8.382; ...
          60     70   60  3.206e-4    7.714; ...
          70     80   70  8.770e-5    6.549; ...
          80     90   80  1.905e-5    5.799; ...
          90    100   90  3.396e-6    5.382; ...
          100    110  100  5.297e-7    5.877; ...
          110    120  110  9.661e-8    7.263; ...
          120    130  120  2.438e-8    9.473; ...
          130    140  130  8.484e-9   12.636; ...
          140    150  140  3.845e-9   16.149; ...
          150    180  150  2.070e-9   22.523; ...
          180    200  180  5.464e-10  29.740; ...
          200    250  200  2.789e-10  37.105; ...
          250    300  250  7.248e-11  45.546; ...
          300    350  300  2.418e-11  53.628; ...
          350    400  350  9.158e-12  53.298; ...
          400    450  400  3.725e-12  58.515; ...
          450    500  450  1.585e-12  60.828; ...
          500    600  500  6.967e-13  63.822; ...
          600    700  600  1.454e-13  71.835; ...
          700    800  700  3.614e-14  88.667; ...
          800    900  800  1.170e-14  124.64; ...
          900   1000  900  5.245e-15  181.05; ...
          1000   1e5  1000  3.019e-15  268.00];

% Matrices allcoation
rho0 = zeros(length(h), 1);
H = zeros(length(h), 1);
h0 = zeros(length(h), 1);
rho = zeros(length(h), 1);

for j = 1:length(h)
    
    for i = 1 : length(table)
        
        if h(j)>= table(i,1)  && h(j) <= table(i,2)
            
            index = i;
            
            break
            
        end
        
    end
    
    
    h0(j) = table(index,3);
    rho0(j) = table(index,4);
    H(j) = table(index,5);
    
    % Density at altitude h
    rho(j) = rho0(j)*exp(-(h(j) - h0(j))/H(j))*1e9;
    
end

end